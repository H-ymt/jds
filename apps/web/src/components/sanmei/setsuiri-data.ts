/**
 * 節入り日時データ（1920年〜2050年）
 * 算命学で正確な月柱を算出するために必要
 *
 * 各月の節気:
 * 1月: 小寒（1月5-7日頃）
 * 2月: 立春（2月3-5日頃）← 年の始まり
 * 3月: 啓蟄（3月5-7日頃）
 * 4月: 清明（4月4-6日頃）
 * 5月: 立夏（5月5-7日頃）
 * 6月: 芒種（6月5-7日頃）
 * 7月: 小暑（7月6-8日頃）
 * 8月: 立秋（8月7-9日頃）
 * 9月: 白露（9月7-9日頃）
 * 10月: 寒露（10月8-9日頃）
 * 11月: 立冬（11月7-8日頃）
 * 12月: 大雪（12月6-8日頃）
 */

// 節入り日データ（日のみ、時刻は省略）
// 形式: [小寒, 立春, 啓蟄, 清明, 立夏, 芒種, 小暑, 立秋, 白露, 寒露, 立冬, 大雪]
export const SETSUIRI_DAYS: Record<number, number[]> = {
  1920: [6, 5, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1921: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1922: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1923: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1924: [6, 5, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1925: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 7],
  1926: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1927: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1928: [6, 5, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1929: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1930: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 7],
  1931: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1932: [6, 5, 6, 5, 5, 6, 7, 8, 8, 8, 7, 7],
  1933: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1934: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 7],
  1935: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1936: [6, 5, 5, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1937: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1938: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1939: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1940: [6, 5, 5, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1941: [6, 4, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1942: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1943: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 8],
  1944: [6, 5, 5, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1945: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 7, 7],
  1946: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1947: [6, 4, 6, 5, 6, 6, 8, 8, 8, 9, 8, 7],
  1948: [6, 5, 5, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  1949: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 7, 7],
  1950: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1951: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1952: [6, 5, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  1953: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1954: [6, 4, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1955: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1956: [6, 5, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  1957: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1958: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 8, 7],
  1959: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1960: [6, 5, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  1961: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1962: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 8, 7],
  1963: [6, 4, 6, 5, 6, 6, 7, 8, 8, 9, 8, 7],
  1964: [6, 5, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  1965: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1966: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 7, 7],
  1967: [6, 4, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1968: [6, 5, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  1969: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1970: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1971: [6, 4, 6, 5, 6, 6, 7, 8, 8, 8, 8, 7],
  1972: [6, 5, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  1973: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1974: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1975: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 8, 7],
  1976: [6, 5, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1977: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1978: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1979: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 8, 7],
  1980: [6, 5, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1981: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  1982: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1983: [6, 4, 6, 5, 5, 6, 7, 8, 8, 8, 8, 7],
  1984: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1985: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  1986: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1987: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 8, 7],
  1988: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1989: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  1990: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1991: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 8, 7],
  1992: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1993: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  1994: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1995: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1996: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  1997: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  1998: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  1999: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2000: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2001: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2002: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2003: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2004: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2005: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2006: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2007: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2008: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2009: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2010: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2011: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2012: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2013: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2014: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2015: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2016: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2017: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2018: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2019: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2020: [6, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2021: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2022: [5, 4, 5, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2023: [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2024: [6, 4, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2025: [5, 3, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2026: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2027: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2028: [6, 4, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2029: [5, 3, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2030: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2031: [5, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7],
  2032: [6, 4, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2033: [5, 3, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2034: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2035: [5, 4, 6, 5, 5, 6, 7, 7, 7, 8, 7, 7],
  2036: [6, 4, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2037: [5, 3, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2038: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2039: [5, 4, 6, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2040: [6, 4, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2041: [5, 3, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2042: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 7],
  2043: [5, 4, 6, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2044: [6, 4, 5, 4, 5, 5, 6, 7, 7, 7, 7, 6],
  2045: [5, 3, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2046: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
  2047: [5, 4, 5, 5, 5, 5, 7, 7, 7, 8, 7, 7],
  2048: [6, 4, 5, 4, 5, 5, 6, 7, 7, 7, 7, 6],
  2049: [5, 3, 5, 4, 5, 5, 6, 7, 7, 8, 7, 6],
  2050: [5, 4, 5, 4, 5, 5, 7, 7, 7, 8, 7, 6],
};

/**
 * 指定年の節入り日を取得
 * @param year 年
 * @param month 月（1-12）
 * @returns 節入り日（1-31）
 */
export function getSetsuiriDay(year: number, month: number): number {
  const data = SETSUIRI_DAYS[year];
  if (data) {
    return data[month - 1];
  }
  // データがない年は近似値を使用
  const defaultDays = [6, 4, 6, 5, 5, 6, 7, 7, 8, 8, 7, 7];
  return defaultDays[month - 1];
}

/**
 * 節入り前かどうかを判定
 * @param year 年
 * @param month 月（1-12）
 * @param day 日
 * @returns 節入り前ならtrue
 */
export function isBeforeSetsuiri(year: number, month: number, day: number): boolean {
  const setsuiriDay = getSetsuiriDay(year, month);
  return day < setsuiriDay;
}
